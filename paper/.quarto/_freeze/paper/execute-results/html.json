{
  "hash": "f1e60dd446dd06417e132a5b9050a90b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Hurricane Effect on Water Quality\ntitle-block-banner: \"dark\"\nauthor: \"William Mullins\"\ntheme: flatly\nformat: \n  html:\n    ouput-file: \"paper.html\"\n---\n\n\n\n\n\n<h1>Background</h1>\nSchaefer et al. (\n<a href=\"https://eds-214-workflows-reproducibility.github.io/course-materials/interactive/interactive-day1am.html#ref-schaefer2000\" role=\"doc-biblioref\" data-original-href=\"https://eds-214-workflows-reproducibility.github.io/course-materials/interactive/interactive-day1am.html#ref-schaefer2000\" aria-expanded=\"false\">2000</a>\n)\nconducted a long-term investigation into the effects of Hurricane Hugo on the water quality of streams in Puerto Rico. They did this by continuously taking measurements of the water's composition after the hurricane hit, which could then be compared against measurements taken years prior. It is the goal of this project to recreate the third figure found in the aforementioned research paper. \n<h1>Data</h1>\n\nOf the measurements they took, the ones of interest to the project are the milligrams of potassium (K), nitrate (NO3), calcium (Ca), magnesium (Mg), and ammonia (NH4). Using the dates attached to these measurements, the rolling means of each variable were calculated and subsequently plotted. \n\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   \n   <th style=\"text-align:center;\"> data_source </th>\n   <th style=\"text-align:center;\"> rolling_mean_k </th>\n   <th style=\"text-align:center;\"> rolling_mean_no3_n </th>\n   <th style=\"text-align:center;\"> rolling_mean_mg </th>\n   <th style=\"text-align:center;\"> rolling_mean_ca </th>\n   <th style=\"text-align:center;\"> rolling_mean_nh4_n </th>\n   <th style=\"text-align:center;\"> week </th>\n   <th style=\"text-align:center;\"> date </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   \n   <td style=\"text-align:center;\"> BQ1 </td>\n   <td style=\"text-align:center;\"> 0.79 </td>\n   <td style=\"text-align:center;\"> 154.38 </td>\n   <td style=\"text-align:center;\"> 2.19 </td>\n   <td style=\"text-align:center;\"> 3.45 </td>\n   <td style=\"text-align:center;\"> 27.38 </td>\n   <td style=\"text-align:center;\"> 4.5 </td>\n   <td style=\"text-align:center;\"> 1988-01-29 </td>\n  </tr>\n  <tr>\n   \n   <td style=\"text-align:center;\"> BQ1 </td>\n   <td style=\"text-align:center;\"> 0.90 </td>\n   <td style=\"text-align:center;\"> 206.94 </td>\n   <td style=\"text-align:center;\"> 1.99 </td>\n   <td style=\"text-align:center;\"> 3.10 </td>\n   <td style=\"text-align:center;\"> 20.69 </td>\n   <td style=\"text-align:center;\"> 9.0 </td>\n   <td style=\"text-align:center;\"> 1988-03-04 </td>\n  </tr>\n  <tr>\n   \n   <td style=\"text-align:center;\"> BQ1 </td>\n   <td style=\"text-align:center;\"> 0.92 </td>\n   <td style=\"text-align:center;\"> 203.89 </td>\n   <td style=\"text-align:center;\"> 1.96 </td>\n   <td style=\"text-align:center;\"> 3.08 </td>\n   <td style=\"text-align:center;\"> 24.06 </td>\n   <td style=\"text-align:center;\"> 13.5 </td>\n   <td style=\"text-align:center;\"> 1988-04-01 </td>\n  </tr>\n  <tr>\n   \n   <td style=\"text-align:center;\"> BQ1 </td>\n   <td style=\"text-align:center;\"> 0.88 </td>\n   <td style=\"text-align:center;\"> 151.70 </td>\n   <td style=\"text-align:center;\"> 2.25 </td>\n   <td style=\"text-align:center;\"> 3.19 </td>\n   <td style=\"text-align:center;\"> 64.20 </td>\n   <td style=\"text-align:center;\"> 18.0 </td>\n   <td style=\"text-align:center;\"> 1988-05-06 </td>\n  </tr>\n  <tr>\n   \n   <td style=\"text-align:center;\"> BQ1 </td>\n   <td style=\"text-align:center;\"> 0.88 </td>\n   <td style=\"text-align:center;\"> 157.50 </td>\n   <td style=\"text-align:center;\"> 2.03 </td>\n   <td style=\"text-align:center;\"> 2.98 </td>\n   <td style=\"text-align:center;\"> 90.62 </td>\n   <td style=\"text-align:center;\"> 22.5 </td>\n   <td style=\"text-align:center;\"> 1988-06-03 </td>\n  </tr>\n  <tr>\n   \n   <td style=\"text-align:center;\"> BQ1 </td>\n   <td style=\"text-align:center;\"> 0.77 </td>\n   <td style=\"text-align:center;\"> NA </td>\n   <td style=\"text-align:center;\"> 2.27 </td>\n   <td style=\"text-align:center;\"> 3.30 </td>\n   <td style=\"text-align:center;\"> 113.00 </td>\n   <td style=\"text-align:center;\"> 27.0 </td>\n   <td style=\"text-align:center;\"> 1988-07-08 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n<h1>Methods</h1>\nThe data was read in and subset to contain only dates located between 1988 and 1994 in order to match the data used in figure 3. After that, in order to calculate the rolling mean, the data was first formatted in the weeks_since_start() function to contain an additional column which contains the number of weeks that have passed between the initial observation and the current observation. This step allows for all observations in a 9 week range to be selected. \n\nThe data frame containing the new column is input into the roll_mean() function which calculates the rolling mean. The function first creates a sequence from 4.5 to the largest number in the week column added before, and counts between the two values by 4.5. A for loop is then used to iterate across the columns containing the five variables mentioned in the background section. That for loop contains a second for loop, which iterates across the sequence generated in the function to create subsets of the data in the columns and finds the mean values in those ranges. The means are then added into a new data frame. A new data frame containing the rolling means of each column and the week count group they belong to is output from the function.\n\nThe data frame output by that function then has the week column created earlier converted back into a standard date format using the weeks_to_dates function. The data frames are then merged together by rows with a column added to distinguish the different data frames. Using the create_combined_graphs function, graphs of each of the five variables are made using ggplot, and they are then merged using patchwork, creating a stack of plots.\n\n<h1>Results</h1>\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](paper_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n<a href=\"https://github.com/willrmull/eds-214-water-quality\" class=\"btn btn-lg btn-primary\">View Repository on Github</a>\n",
    "supporting": [
      "paper_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"paper_files/libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"paper_files/libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}