{"title":"Hurricane Effect on Water Quality","markdown":{"yaml":{"title":"Hurricane Effect on Water Quality","title-block-banner":"dark","author":"William Mullins","theme":"flatly","format":{"html":{"ouput-file":"paper.html"}}},"headingText":"Load functions","containsRefs":false,"markdown":"\n\n```{r}\n#| include: false\n\nlibrary(here)\nlibrary(janitor)\nlibrary(tidyverse)\nlibrary(lubridate)\nlibrary(patchwork)\nlibrary(viridis)\nlibrary(hrbrthemes)\n\nsource(\"../R/roll_mean.R\")\nsource(\"../R/weeks_since_start.R\")\nsource(\"../R/weeks_to_dates.R\")\nsource(\"../R/create_combined_graph.R\")\n```\n\n<h1>Background</h1>\nSchaefer et al. (\n<a href=\"https://eds-214-workflows-reproducibility.github.io/course-materials/interactive/interactive-day1am.html#ref-schaefer2000\" role=\"doc-biblioref\" data-original-href=\"https://eds-214-workflows-reproducibility.github.io/course-materials/interactive/interactive-day1am.html#ref-schaefer2000\" aria-expanded=\"false\">2000</a>\n)\nconducted a long-term investigation into the effects of Hurricane Hugo on the water quality of streams in Puerto Rico. They did this by continuously taking measurements of the water's composition after the hurricane hit, which could then be compared against measurements taken years prior. It is the goal of this project to recreate the third figure found in the aforementioned research paper. \n<h1>Data</h1>\n\nOf the measurements they took, the ones of interest to the project are the milligrams of potassium (K), nitrate (NO3), calcium (Ca), magnesium (Mg), and ammonia (NH4). Using the dates attached to these measurements, the rolling means of each variable were calculated and subsequently plotted. \n\n```{r, echo = FALSE}\n# Read in clean data\nmerged_data_frame <- read.csv(here::here(\"outputs\", \"clean_data.csv\"))\nmerged_data_frame$date <-lubridate::as_date(merged_data_frame$date)\n\n# View\ndata_sub <- head(merged_data_frame) \nknitr::kable(data_sub, digits = 3)\n```\n\n<h1>Methods</h1>\nThe data was read in and subset to contain only dates located between 1988 and 1994 in order to match the data used in figure 3. After that, in order to calculate the rolling mean, the data was first formatted in the weeks_since_start() function to contain an additional column which contains the number of weeks that have passed between the initial observation and the current observation. This step allows for all observations in a 9 week range to be selected. \n\nThe data frame containing the new column is input into the roll_mean() function which calculates the rolling mean. The function first creates a sequence from 4.5 to the largest number in the week column added before, and counts between the two values by 4.5. A for loop is then used to iterate across the columns containing the five variables mentioned in the background section. That for loop contains a second for loop, which iterates across the sequence generated in the function to create subsets of the data in the columns and finds the mean values in those ranges. The means are then added into a new data frame. A new data frame containing the rolling means of each column and the week count group they belong to is output from the function.\n Data frame output by that function then has its week column converted back into dates using the weeks_to_dates function. The data frames are then merged. Using the create_combined_graphs function, graphs of each of the five variables are made using ggplot, and they are then merged using patchwork, creating a stack of plots.\n\n<h1>Results</h1>\n\n```{r, echo = FALSE, warning=FALSE}\n# Plotting the data\n# Runs the testing file\nmerged_plots <- create_combined_graph(merged_data_frame) + plot_layout(axes = \"collect\", guides = \"collect\") & \n  theme(plot.margin = unit(c(0.1,0.1,0.1,0.1), \"cm\"), \n        axis.title.x = element_text(hjust = 0.5, size = 15))\n\n\nmerged_plots + geom_vline(xintercept = 1980, linetype = \"dashed\", color = \"black\")\n \nggsave(plot = merged_plots, here::here(\"outputs\", \"figs\", \"merged_plots.jpg\"), width = 6, height = 4)\n\n```\n\n<a href=\"https://github.com/willrmull/eds-214-water-quality\" class=\"btn btn-lg btn-primary\">View Repository on Github</a>\n","srcMarkdownNoYaml":"\n\n```{r}\n#| include: false\n\nlibrary(here)\nlibrary(janitor)\nlibrary(tidyverse)\nlibrary(lubridate)\nlibrary(patchwork)\nlibrary(viridis)\nlibrary(hrbrthemes)\n\n# Load functions \nsource(\"../R/roll_mean.R\")\nsource(\"../R/weeks_since_start.R\")\nsource(\"../R/weeks_to_dates.R\")\nsource(\"../R/create_combined_graph.R\")\n```\n\n<h1>Background</h1>\nSchaefer et al. (\n<a href=\"https://eds-214-workflows-reproducibility.github.io/course-materials/interactive/interactive-day1am.html#ref-schaefer2000\" role=\"doc-biblioref\" data-original-href=\"https://eds-214-workflows-reproducibility.github.io/course-materials/interactive/interactive-day1am.html#ref-schaefer2000\" aria-expanded=\"false\">2000</a>\n)\nconducted a long-term investigation into the effects of Hurricane Hugo on the water quality of streams in Puerto Rico. They did this by continuously taking measurements of the water's composition after the hurricane hit, which could then be compared against measurements taken years prior. It is the goal of this project to recreate the third figure found in the aforementioned research paper. \n<h1>Data</h1>\n\nOf the measurements they took, the ones of interest to the project are the milligrams of potassium (K), nitrate (NO3), calcium (Ca), magnesium (Mg), and ammonia (NH4). Using the dates attached to these measurements, the rolling means of each variable were calculated and subsequently plotted. \n\n```{r, echo = FALSE}\n# Read in clean data\nmerged_data_frame <- read.csv(here::here(\"outputs\", \"clean_data.csv\"))\nmerged_data_frame$date <-lubridate::as_date(merged_data_frame$date)\n\n# View\ndata_sub <- head(merged_data_frame) \nknitr::kable(data_sub, digits = 3)\n```\n\n<h1>Methods</h1>\nThe data was read in and subset to contain only dates located between 1988 and 1994 in order to match the data used in figure 3. After that, in order to calculate the rolling mean, the data was first formatted in the weeks_since_start() function to contain an additional column which contains the number of weeks that have passed between the initial observation and the current observation. This step allows for all observations in a 9 week range to be selected. \n\nThe data frame containing the new column is input into the roll_mean() function which calculates the rolling mean. The function first creates a sequence from 4.5 to the largest number in the week column added before, and counts between the two values by 4.5. A for loop is then used to iterate across the columns containing the five variables mentioned in the background section. That for loop contains a second for loop, which iterates across the sequence generated in the function to create subsets of the data in the columns and finds the mean values in those ranges. The means are then added into a new data frame. A new data frame containing the rolling means of each column and the week count group they belong to is output from the function.\n Data frame output by that function then has its week column converted back into dates using the weeks_to_dates function. The data frames are then merged. Using the create_combined_graphs function, graphs of each of the five variables are made using ggplot, and they are then merged using patchwork, creating a stack of plots.\n\n<h1>Results</h1>\n\n```{r, echo = FALSE, warning=FALSE}\n# Plotting the data\n# Runs the testing file\nmerged_plots <- create_combined_graph(merged_data_frame) + plot_layout(axes = \"collect\", guides = \"collect\") & \n  theme(plot.margin = unit(c(0.1,0.1,0.1,0.1), \"cm\"), \n        axis.title.x = element_text(hjust = 0.5, size = 15))\n\n\nmerged_plots + geom_vline(xintercept = 1980, linetype = \"dashed\", color = \"black\")\n \nggsave(plot = merged_plots, here::here(\"outputs\", \"figs\", \"merged_plots.jpg\"), width = 6, height = 4)\n\n```\n\n<a href=\"https://github.com/willrmull/eds-214-water-quality\" class=\"btn btn-lg btn-primary\">View Repository on Github</a>\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"paper.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.42","title":"Hurricane Effect on Water Quality","title-block-banner":"dark","author":"William Mullins","theme":"flatly","ouput-file":"paper.html"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":[]}